from pomp.example_problems.shuffling import *

states =[[-0.0004687127117963906, 4.475270171853597, -3.716115260398554e-05, 0.0, 1.5707963267948966, 0.0010890719825592788, 1.5419406557725666e-05, -0.010176900068066768, -0.09839539858288511, -0.020428664854210795, -1.9165416641681947e-05, -2.7276243319636765e-05, -0.18134111775999626, 0.26657490900230735, 0.018012798794595036, -0.10577174984276015, -0.32478773731896715, 0.2613812246766616, 0.5591510297427972, -0.5042637161003448, 5.17544404712038], [-0.09594407608859111, 4.323401173227447, 6.417072409512512e-05, -1.5708395829005024, 1.229560050686596, -1.5691331085453992, 0.0005270333203215759, -0.20223604302423626, -0.38296281898259765, -1.193990453486715, -0.0019808008211766193, -0.00026307140075233223, 0.2967362190374877, -0.34609994767182944, 0.4716160045475922, 0.5407037661026866, 2.1390323959265665, -1.5819049280844646, 0.6488861010197964, 0.22112160062858946, 5.086760742717673], [-0.38262988032758183, 4.27064859080805, 0.000783274362244287, -1.5707983557107141, 0.6440369032648686, -1.5691858025610113, 0.000634350218241901, -0.1643859652392575, 0.0026338951254375517, -0.3194664429033185, -0.0005392309849909221, 0.0013778911802369643, 0.5351535686949859, 0.5604558360607192, 0.15418707418279112, -0.25551937695612553, 0.4079623021043641, 0.20753873035538078, -1.1705467410745962, 1.9069973539251401, 4.910753239006868], [-0.2948169585923235, 4.07220163265989, 0.015086003274938663, -1.5701965656823174, 0.3965241377873903, -1.5865881544157687, 0.01680525707617589, 0.010354040965165795, -0.029247296067780745, -0.36644193711638134, 0.003885093651386993, -0.01750150466625709, 0.5549283513488719, 0.5161760627949765, 0.022395488680603728, 0.2718403518044929, 0.22936952486500947, 0.10878404012192514, 0.45539601354129855, -2.263845762963973, 4.741324321858028], [-0.27971752281589607, 3.8839465746747153, 0.020012923213320842, -1.5740635529462306, 0.30088092178209375, -1.6003103998579316, -8.33033548353368e-05, 0.009535093596080655, -0.14980674862224783, 0.3062550330425108, -0.02047409825688075, -0.01605677753069853, 0.5572331896359725, 0.1424732064529447, 0.06664037434134241, 0.011960934981231587, -0.547095242556795, 0.6595644342512885, -2.292452628805066, 3.432871692943627, 4.570813369639389], [-0.3985753505621931, 3.5224744823601966, 0.016133479120360658, -1.597919624922271, 0.9345536360819607, -1.6136872645111682, -0.0035882904000573983, -0.12317904933515225, -0.4592152321141116, 1.3183931305952787, -0.005459596361001523, -0.009675249554121646, -0.313466943089507, 0.13277567662602666, -0.4584348979725135, -0.03888384802374445, -2.422479648541083, 0.7435379620219887, 1.4711872841560425, -3.6472046476734676, 4.430186229577269], [-0.3932218627582233, 2.472343449189133, -0.006976990695413654, -1.6312658193658254, 0.1361881059282458, -1.5926423732034467, -0.033068218080488744, -0.07630983103638377, -0.7554854127455967, -2.0881969606469566, 0.056991176333333324, 0.12233927403942466, -0.029626195567445068, 0.07065431827017987, -0.03202197731801548, 0.1080710043763586, 2.893025878203777, -2.2130153147295966, 3.004800046512572, -3.4113105989108274, 4.268620588431998]]
inputs= [[1.5401243131089017, 0.19814484646188657, 0.16699084954287935, -0.13016202215325812, 0.468857329831331], [1.8682524909844804, 0.08166396253132302, 0.16620198758705085, 0.03358908468975774, -0.2539668531572037], [1.9857022180144195, 0.10163271498996207, 0.48293161942798946, -0.3323233933036942, -0.15354399806828933], [1.9137487298055584, 0.27203785612601583, 0.29690602126922505, 0.1457301455592438, -0.0457713775303914], [1.4946544689029553, 0.015912049002288597, 0.14266177149951376, -0.16846038002948693, 0.47431365636998324], [1.707404513959569, -0.40226494084182407, -0.12008043152345294, 0.43304193908472266, 0.3817869648979584]]

# movable_joints = [1,2,3,5,6,7,9,10,11]
# num_joints = len(movable_joints)
# num_dim_se3 = 6
# data = [0.0, 1., 0.0, 0.0, 0.0, 0.0] + [0.0,]*num_dim_se3 + [math.pi/12]*num_joints + [0.0]*num_joints
# gripper_vel = data[-num_joints:]
data = [-0.0004687127117963906,4.475270171853597,-3.716115260398554e-05,0.0,1.5707963267948966,0.0010890719825592788,1.5419406557725666e-05,-0.010176900068066768,-0.09839539858288511,-0.020428664854210795,-1.9165416641681947e-05,-2.7276243319636765e-05,-0.18134111775999626,0.26657490900230735,0.018012798794595036,-0.10577174984276015,-0.32478773731896715,0.2613812246766616,0.5591510297427972,-0.5042637161003448,5.17544404712038,-0.09480624419280961]
gripper_vel = data[-1:]
dynamics_sim = forwardSimulationShuffling(gui=1)

cage = Shuffling(data, dynamics_sim)
cage.controlSpace()
time.sleep(2.5)

new_states = states[0]
for i in range(len(inputs)):
    print('new_states', new_states)
    dynamics_sim.reset_states(states[i]+gripper_vel)
    new_states, viapoints = dynamics_sim.run_forward_sim(inputs[i])

dynamics_sim.finish_sim()
