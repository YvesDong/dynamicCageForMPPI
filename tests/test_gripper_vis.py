from pomp.example_problems.gripper import *

states = [[0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494, 0.2617993877991494], [-0.06677433022280728, 0.8141585785601732, 0.002442671042852834, 2.8093908773514402e-08, -0.01778688829753544, 7.514958743874604e-07, 0.1242150857156316, -2.429146709325061e-07, -0.119667936858744, -5.996003298117362e-07, 0.40790715619940454, 3.7933261961078674e-08, 0.25659461720854565, 0.27068738596562825, 0.2581161736077256, 0.2565945794992875, 0.27068743255178374, 0.25811614688459117, 0.24188288692828291, 0.27243606072647875, 0.2592486888197901], [-0.08484045449380305, 0.8461022011922223, -0.007182348227931149, 0.017725896620956316, -0.05662540478039676, 0.00029483190622132987, -0.1154849675218743, -0.003359618911148636, 0.07255968510334108, 0.00037008642532671004, -0.20983351743973863, 0.14762495994654706, 0.25659305902254126, 0.2706901132788101, 0.25811499108218977, 0.2565930590249809, 0.27069011327926074, 0.2581149910931154, 0.24188023521903484, 0.2724371282703, 0.25924692985909376], [0.016101861063030628, 0.8087898080725466, -0.014336526973239757, 1.662921109143002e-05, 2.660350742049095e-05, -0.015112781977628262, 0.3106558882062606, -0.024259069729245197, -0.0030541455105637712, -0.017383639561911312, -0.0002951961828018089, -0.03525999569108675, 0.2565930595416503, 0.2706901127790135, 0.2581149918891209, 0.25659305821259826, 0.27069011445466895, 0.2581149906572957, 0.2418802361994082, 0.2724371281748947, 0.25924692975985103], [0.01878886170719059, 1.1164561247556588, -0.030016808833371246, -0.00972314589358667, -0.01322666847559867, -0.035997462610450726, -0.29454387800752874, -0.023310375309181446, 0.9239829992390738, -0.013416551613012853, -0.038780690443765135, -0.02838115107116809, 0.2565930590062449, 0.27069011330603165, 0.25811499106950575, 0.2565930590091581, 0.2706901133063708, 0.25811499108186325, 0.24188023619864332, 0.2724371281750802, 0.25924692975994296], [0.10925061729980572, 1.1047253866553304, 0.0037604735302080032, 0.2235232565946251, -0.726646207164307, -0.1504137727744626, 0.0034055022960034903, 0.06577758956442131, -0.5409998145172104, 0.35054877339857937, -0.6915015091469319, -0.011514873596246308, 0.25659331147342185, 0.27069044925722163, 0.2581151194128528, 0.25659326417144107, 0.27069014528601765, 0.2581150333772367, 0.2422646847257479, 0.27240596411814444, 0.25925099272659075], [0.04087227969684747, 0.8691429682890612, 0.11498297607249851, 3.164433408682978e-06, -1.340968295442199, -0.09215178440022283, -0.11097055546830184, 0.09094215018788149, -0.19763737874523493, -0.08154814055706767, -0.8850578662158237, -0.14426414587293296, 0.2565930590076039, 0.27069011330810216, 0.25811499106950625, 0.25659305901055146, 0.2706901133062055, 0.2581149910820428, 0.24188064251169514, 0.2724371197677276, 0.25924692089839424], [0.12925320070394405, 0.9903767389547793, 0.20848811800161096, -2.3104135477217054, -1.4621725661573104, 2.074813257551643, 0.2533070768698005, 0.12536568095814513, 0.45689115926433665, -0.1014140035252047, 0.3984825994341145, -0.19242517954169044, 0.2565930590061299, 0.2706901133061563, 0.25811499106934876, 0.2565930590093307, 0.27069011330610576, 0.25811499108196867, 0.24223340534975155, 0.27255255587929667, 0.2591441598811491], [0.19996911116443467, 0.8160776197038822, 0.4285377089151422, -2.192143576885429, -1.4917258286225445, 1.4665886429551849, -0.00045256569253199663, 0.32573924102536794, 0.02078974211196983, -0.5051260042147605, -0.10520824656825573, -0.6379623410855327, 0.2565930590061299, 0.2706901133061563, 0.25811499106934876, 0.2565930590093307, 0.27069011330610576, 0.25811499108196867, 0.2418305320435455, 0.2724460289797735, 0.259254137637753], [-0.10120013812505481, 0.728908810242508, 0.7531166481082072, -2.7005549809641183, -1.0701928749658691, 1.5017433249961325, -0.6053032677257713, 0.4082063701725975, -0.26916404853324, -0.6978042846518373, -0.11175236641106483, -0.2918840952748774, 0.2565930590061299, 0.2706901133061563, 0.25811499106934876, 0.2565930590093307, 0.27069011330610576, 0.25811499108196867, 0.24188024540528386, 0.27243712700492523, 0.25924692895619356], [-0.518108365090345, -0.1011983164673367, 1.2483306863868577, -2.8630347293641067, -0.5356375077672743, 2.091030375913152, -0.6385256182153625, 0.6940482404885112, -1.7172479643371674, -0.2842293608858689, -0.026932966535131445, 0.40630024501452816, 0.2565930590061299, 0.2706901133061563, 0.25811499106934876, 0.25659305900933044, 0.27069011330610565, 0.25811499108196867, 0.2418802361955465, 0.2724371281752713, 0.2592469297601385], [-0.7000721867846871, -1.7743122354332304, 1.8405417651850293, -2.6876049658083248, -0.32100912309150853, 2.3746003057575122, 0.21497073273289852, 0.6230208970239494, -1.9929261097897155, -0.3142605489988065, 0.011244736102049376, 0.38091958155905553, 0.2565930590061299, 0.2706901133061563, 0.25811499106934876, 0.25659305900933044, 0.27069011330610565, 0.25811499108196867, 0.241880236198644, 0.27243712817508015, 0.25924692975994296]]
inputs= [[0.6458869204472161, -0.7407334773762095, 0.0, 8.479164551746482, -0.002634097956484449, -0.23521965012587287, -0.25321564770553473], [0.9158767357540941, -0.29189669276676233, 0.0, 9.859938511759593, -0.1420874931926124, 0.010171784927977545, 0.09869519352000411], [0.6355712447065287, 0.8415505981170481, 0.0, 7.898303753410788, -0.22728953959182116, -0.20971659185101466, -0.052499753435655216], [0.6604630655172229, -0.9203407122502808, 0.0, 11.248459908540806, 0.021536733431154476, -0.23709274323406448, 0.036491237063693005], [0.9481164626528591, 1.1405749356481163, 0.0, 8.799022217131409, 0.044661828442295715, 0.1090202365408488, -0.09187900180875308], [0.952708586953731, 0.10891156144595171, 0.0, 8.822884648148811, -0.14993406885500613, 0.23232428569246938, -0.21335432786728756], [0.9058547495404607, 0.6972397140089721, 0.0, 10.471911972753263, -0.026030606843642057, 0.23297762794643756, -0.13247994914965833], [0.9130126577902434, 0.6032085556552251, 0.0, 7.293554175655567, 0.2781263353905116, -0.2767459208462088, 0.1582014694194258], [0.9543285183766779, -0.8269434322132099, 0.0, 8.638499030936693, -0.02028642175396861, 0.21488654234161136, 0.13640413154989578], [0.8533012698554608, -0.3121395842028445, 0.0, 7.530982223661528, 0.21870563424595352, -0.04497688339431416, -0.25708672045991454], [0.9040693665756574, 0.924013249151241, 0.0, 9.280766799345194, -0.20505336273139194, 0.16782116911408596, -0.018680195384249865]]

movable_joints = [1,2,3,5,6,7,9,10,11]
num_joints = len(movable_joints)
num_dim_se3 = 6
data = [0.0, 1., 0.0, 0.0, 0.0, 0.0] + [0.0,]*num_dim_se3 + [math.pi/12]*num_joints + [0.0]*num_joints
gripper_vel = data[-num_joints:]
dynamics_sim = forwardSimulationGripper(gui=1)

cage = Gripper(data, dynamics_sim, movable_joints)
cage.controlSpace()
time.sleep(2.5)

new_states = states[0]
for i in range(len(inputs)):
    print('new_states', new_states)
    dynamics_sim.reset_states(states[i]+gripper_vel)
    new_states, viapoints = dynamics_sim.run_forward_sim(inputs[i])

dynamics_sim.finish_sim()
